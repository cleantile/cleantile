<!--
  @license
  Copyright (c) 2016 Ryan Leonard.  All rights reserved.
  This code may only be used under the MIT style license found at http://github.com/cleantile/cleantile/LICENSE
--><!--
  This HTML was compiled from [Blade] source code.  Please edit the Blade file instead of the HTML.
  Most Blade files are in the same directory as the compiled HTML file.

  [Blade]: https://github.com/bminer/node-blade
--><script type="text/javascript">
(function() {
  if (window.CleanTile == null) {
    window.CleanTile = {};
  }


  /**
Describes a partion between the two sides of a [`<cleantile-split>`][].  Used in [`<cleantile-drag>`][].

Custom drag elements **must** extend the DragBehavior to be recognized by [`<cleantile-split>`][], and be sent data as
it changes.

    <dom-module id="narrow-drag">
      <template>
      </template>
      <script>
        Polymer({
          is: "narrow-drag",
          behaviors: [CleanTile.DragBehavior],
          ready: function() {
            // this.name can be preset via `<wrapper-file-preview name="File: index.html">`
            if(!this.name) {
              this.name = "File Preview";
            }
          }
        })
      </ script >
    </dom-module>

[`<cleantile-split>`]: #cleantile-split
[`<cleantile-drag>`]: #cleantile-drag

@polymerBehavior
   */

  CleanTile.DragBehavior = {
    properties: {

      /**
Determines if the elements in the parent split are nested above each other (`vertical`) or next to each other
(`horizontal`).

Value automatically fetched from parent `cleantile-split`.
       */
      direction: {
        type: String,
        value: "horizontal",
        reflectToAttribute: true
      },

      /**
Sets the division point between the two elements of the parent split.  Can contain:

- `val` (`<cleantile-split>.boundary`)
- `min` (`<cleantile-split>.min-boundary`)
- `max` (`<cleantile-split>.max-boundary`)

The parent split will be notified of changes to any of the fields in `boundary`.
       */
      boundary: {
        type: Object,
        value: function() {
          return {};
        }
      },

      /**
The amount of space that should be left between the two sides of the split for the dragger.

Additional padding around the bar should be included in the `width` property, and CSS inside the dragger should
add the margin on either side of the bar.
       */
      width: {
        type: Number,
        value: 0,
        observer: "_widthChanged"
      }
    },
    observers: ["_boundaryChanged(boundary.val, boundary.min, boundary.max)"],

    /**
Returns the parent split, if one exists.
@return {HTMLElement} the `<cleantile-split>`, if one exists.
     */
    split: function() {
      var e, parent;
      try {
        parent = Polymer.dom(this).parentNode;
        while (parent.tagName.toLowerCase() !== "cleantile-split") {
          parent = parent.parentNode;
        }
        return parent;
      } catch (error) {
        e = error;
      }
    },

    /**
If the parent split has been initialized, fetch property values.
     */
    ready: function() {
      var split;
      split = this.split();
      if (split && split.get) {
        this.pullDirection();
        return this.pullBoundary();
      } else {
        return setTimeout((function(_this) {
          return function() {
            _this.pullDirection();
            return _this.pullBoundary();
          };
        })(this), 0);
      }
    },

    /**
Fetch 'direction' from parent split.
     */
    pullDirection: function(split) {
      if (split == null) {
        split = this.split();
      }
      if (!split.get) {
        return;
      }
      return this.set("direction", split.get("direction"));
    },

    /**
Fetch 'boundary' from parent split.
     */
    pullBoundary: function(split) {
      if (split == null) {
        split = this.split();
      }
      if (!split.get) {
        return;
      }
      return this.set("boundary", {
        val: split.get("boundary"),
        min: split.get("min-boundary"),
        max: split.get("max-boundary")
      });
    },

    /**
Keeps the parent `<cleantile-split>` in sync with the properties in `boundary`.
     */
    _boundaryChanged: function(val, min, max) {
      var split;
      console.log("Updating boundary");
      if (!((split = this.split()) && split.set)) {
        return console.warn("Can't update boundary of split");
      }
      split.set("boundary", val);
      split.set("min-boundary", min);
      return split.set("max-boundary", max);
    },

    /**
Keeps the parent `<cleantile-split>` in sync with this split's `width`.
     */
    _widthChanged: function(width) {
      var split;
      if ((split = this.split()) && split.set) {
        return split.set("dragWidth", width);
      }
    }
  };

}).call(this);

</script>